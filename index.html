<!-- 在原index.html的"添加新客户"部分后面添加导出和导入功能 -->

<!-- 数据导出功能 -->
<div class="section">
    <h2 class="section-title">📤 数据导出</h2>
    <div id="exportAlert" class="alert"></div>
    
    <div class="form-row">
        <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
            <label style="font-weight: 500; color: #2c3e50;">导出格式:</label>
            <select id="exportFormat" class="form-control" style="width: 150px;">
                <option value="csv">CSV格式</option>
                <option value="excel">Excel格式</option>
            </select>
            
            <select id="exportType" class="form-control" style="width: 150px;">
                <option value="full">完整数据</option>
                <option value="simple">简化数据</option>
            </select>
            
            <button onclick="exportData()" class="btn" style="background: #2ecc71;">
                <span style="margin-right: 5px;">⬇️</span>导出当前数据
            </button>
            
            <button onclick="downloadTemplate('csv')" class="btn" style="background: #3498db;">
                📋 CSV模板
            </button>
            
            <button onclick="downloadTemplate('excel')" class="btn" style="background: #9b59b6;">
                📋 Excel模板
            </button>
        </div>
    </div>
    
    <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px dashed #ddd;">
        <div style="font-size: 13px; color: #7f8c8d;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                <span style="color: #2ecc71;">✓</span>
                <span><strong>完整数据</strong>: 包含所有字段，适合备份</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
                <span style="color: #3498db;">✓</span>
                <span><strong>简化数据</strong>: 只包含关键字段，适合快速查看</span>
            </div>
        </div>
    </div>
</div>

<!-- 批量导入功能 -->
<div class="section">
    <h2 class="section-title">📥 批量导入</h2>
    <div id="importAlert" class="alert"></div>
    
    <div class="form-row" style="align-items: flex-start;">
        <div style="flex: 1;">
            <label style="display: block; margin-bottom: 8px; color: #2c3e50; font-weight: 500;">
                选择文件 (支持CSV/Excel)
            </label>
            <input type="file" id="importFile" accept=".csv,.xlsx,.xls" class="form-control" 
                   style="padding: 8px 15px; cursor: pointer;">
            
            <div style="margin-top: 8px; font-size: 13px; color: #7f8c8d;">
                支持格式: CSV (.csv), Excel (.xlsx, .xls)
            </div>
        </div>
        
        <div style="display: flex; gap: 10px; align-items: flex-end;">
            <button onclick="previewImport()" class="btn" style="background: #f39c12;">
                👁️ 预览数据
            </button>
            <button onclick="clearImport()" class="btn" style="background: #95a5a6;">
                清除
            </button>
        </div>
    </div>
    
    <!-- 导入预览区域 -->
    <div id="importPreview" style="display: none; margin-top: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 style="font-size: 16px; color: #2c3e50;">📋 导入预览</h3>
            <div id="importStats" style="font-size: 14px; color: #7f8c8d;"></div>
        </div>
        
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                <thead>
                    <tr style="background: #f8f9fa;">
                        <th style="padding: 8px; text-align: center; border: 1px solid #dee2e6;">行号</th>
                        <th style="padding: 8px; text-align: left; border: 1px solid #dee2e6;">账号ID</th>
                        <th style="padding: 8px; text-align: left; border: 1px solid #dee2e6;">服务器</th>
                        <th style="padding: 8px; text-align: left; border: 1px solid #dee2e6;">识别码</th>
                        <th style="padding: 8px; text-align: left; border: 1px solid #dee2e6;">到期时间</th>
                        <th style="padding: 8px; text-align: left; border: 1px solid #dee2e6;">状态</th>
                        <th style="padding: 8px; text-align: left; border: 1px solid #dee2e6;">验证状态</th>
                    </tr>
                </thead>
                <tbody id="previewBody">
                    <!-- 预览数据将通过JavaScript动态填充 -->
                </tbody>
            </table>
        </div>
        
        <!-- 错误信息区域 -->
        <div id="importErrors" style="display: none; margin-top: 15px;">
            <div style="padding: 15px; background: #fef5e7; border-radius: 6px; border: 1px solid #f8c471;">
                <h4 style="margin: 0 0 10px 0; color: #f39c12;">⚠️ 发现错误</h4>
                <div id="errorList" style="max-height: 150px; overflow-y: auto; font-size: 13px;"></div>
            </div>
        </div>
        
        <!-- 导入按钮 -->
        <div id="importActions" style="display: none; margin-top: 20px; text-align: right;">
            <button onclick="executeImport()" class="btn" style="background: #2ecc71;">
                ✅ 确认导入
            </button>
            <button onclick="cancelImport()" class="btn" style="background: #95a5a6; margin-left: 10px;">
                取消
            </button>
        </div>
    </div>
    
    <!-- 导入结果模态框 -->
    <div id="importResultModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-title">
                <span style="margin-right: 10px;">📊</span>导入结果
            </div>
            
            <div id="importResultContent" style="max-height: 400px; overflow-y: auto;">
                <!-- 导入结果将通过JavaScript动态填充 -->
            </div>
            
            <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
                <button onclick="closeImportResult()" class="btn" style="background: #95a5a6;">
                    关闭
                </button>
                <button onclick="closeImportResultAndRefresh()" class="btn" style="background: #2ecc71; margin-left: 10px;">
                    关闭并刷新列表
                </button>
            </div>
        </div>
    </div>
</div>